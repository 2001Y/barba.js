---
# Front matter comment to ensure Jekyll properly reads file.
---

{% include header.html %}
{% include nav.html %}

<div id="barba-wrapper">
<div class="barba-container">

<h1>Transition</h1>

<p>A transition is a Javascript object that will make sure to hide the old container and display the new one.</p>

<p>All the transitions need to extend the <a href="https://github.com/luruke/barba.js/blob/master/src/Transition/BaseTransition.js" target="_blank">Barba.BaseTransiton</a> object.</p>

<blockquote>
  <p>Please note: the transition starts even before the new page is loaded. This way you can start your own transition even before the next page is loaded.</p>
</blockquote>

<p>Extending this object your transition will inherit the following members:</p>

<table>
  <thead>
    <tr>
      <th>Member</th>
      <th>Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>start</code></td>
      <td><code>function</code> that will be called automatically when your transition starts. (you can consider it the constructor of your transition)</td>
    </tr>
    <tr>
      <td><code>done</code></td>
      <td>
        <code>function</code> that needs to be called when your transition is finished.<br>
        <b>Do not forget to call this function!</b>
      </td>
    </tr>
    <tr>
      <td><code>oldContainer</code></td>
      <td><code>HTMLElement</code> of the old container.</td>
    </tr>
    <tr>
      <td><code>newContainerLoading</code></td>
      <td><code>Promise</code> that will indicate the loading of the next container.</td>
    </tr>
    <tr>
      <td><code>newContainer</code></td>
      <td>
        <code>HTMLElement</code> of the new container. (with <code>visibility: hidden;</code>)<br>
        <b>Please note, it's <code>undefined</code> until <code>newContainerLoading</code> is resolved!</b>
      </td>
    </tr>
  </tbody>
</table>

<h2>HideShow Example</h2>

<p>By default barba.js uses a simple HideShow transition. In order to understand how it works, let's recreate it:</p>

{% highlight javascript %}
var HideShowTransition = BaseTransition.extend({
  start: function() {
    this.newContainerLoading.then(this.finish.bind(this));
  },

  finish: function() {
    document.body.scrollTop = 0;
    this.done();
  }
});
{% endhighlight %}

<blockquote>
  <p>As you noticed we used a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><code>Promise</code></a>; barba.js also comes with an handy Promise polyfill.</p>
</blockquote>

<p>Next, we have to tell barba.js to use our new transition:</p>

{% highlight javascript %}
Barba.Pjax.getTransition = function() {
  return HideShowTransition;
};
{% endhighlight %}

<h2>FadeTransition Example</h2>

<p>Let's create now a more complex transition, a FadeTransition using jQuery's <code>.animate()</code></p>

<blockquote>
  <p>Of course you can use any JS library, plain Javascript method, CSS transitions, or something else instead.</p>
</blockquote>

{% highlight javascript %}
var FadeTransition = Barba.BaseTransition.extend({
  start: function() {
    /**
     * This function is automatically called as soon the Transition starts
     * this.newContainerLoading is a Promise for the loading of the new container
     * (Barba.js also comes with an handy Promise polyfill!)
     */

    // As soon the loading is finished and the old page is faded out, let's fade the new page
    Promise
      .all([this.newContainerLoading, this.fadeOut()])
      .then(this.fadeIn.bind(this));
  },

  fadeOut: function() {
    /**
     * this.oldContainer is the HTMLElement of the old Container
     */

    return $(this.oldContainer).animate({ opacity: 0 }).promise();
  },

  fadeIn: function() {
    /**
     * this.newContainer is the HTMLElement of the new Container
     * At this stage newContainer is on the DOM (inside our #barba-container and with visibility: hidden)
     * Please note, newContainer is available just after newContainerLoading is resolved!
     */

    var _this = this;
    var $el = $(this.newContainer);

    $(this.oldContainer).hide();

    $el.css({
      visibility : 'visible',
      opacity : 0
    });

    $el.animate({ opacity: 1 }, 400, function() {
      /**
       * Do not forget to call .done() as soon your transition is finished!
       * .done() will automatically remove from the DOM the old Container
       */

      _this.done();
    });
  }
});

/**
 * Next step, you have to tell Barba to use the new Transition
 */

Barba.Pjax.getTransition = function() {
  /**
   * Here you can use your own logic!
   * For example you can use different Transition based on the current page or link...
   */

  return FadeTransition;
};
{% endhighlight %}

</div>
</div>

{% include footer.html %}
